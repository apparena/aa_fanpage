<?php
include_once ( '../init.php' );
require_once('../libs/Zend/Feed/Rss.php');
require_once('../libs/Zend/Feed/Atom.php');
require_once('../libs/Zend/Feed/Reader.php');
require_once('../libs/opengraph/OpenGraph.php');
try {

    $feed = Zend_Feed_Reader::import( $aa['config']['rss_feed1_url']['value'] );

    $data = array(
        'title'        => $feed->getTitle(),
        'link'         => $feed->getLink(),
        'dateModified' => $feed->getDateModified(),
        'description'  => $feed->getDescription(),
        'language'     => $feed->getLanguage(),
        'entries'      => array(),
    );
    foreach ($feed as $entry) {
        $edata = array(
            'title'        => $entry->getTitle(),
            'description'  => $entry->getDescription(),
            'dateModified' => $entry->getDateModified(),
            'author'       => $entry->getAuthor(),
            'link'         => $entry->getLink(),
            'content'      => $entry->getContent()
        );
        $data['entries'][] = $edata;
    }
}
catch (Exception $e){
    var_dump($e);
}

?>
<!-- Social News Page -->
<div class="page2">
    <div class="row">
        <div class="span2">
            <div class="logo">
                <?=$aa['config']['header_logo']['value'];?>
            </div>

            <?php if ( $aa['config']['header_sm_activated']['value'] ) {
            include_once("menu_social_media.phtml");
        }  ?>

            <?php include_once("menu_left.phtml"); ?>
        </div>

        <!-- RSS Feed Items -->
        <div class="span8">
            <?php
            foreach ( $data['entries'] as $item ) {
                $graph = OpenGraph::fetch( $item['link'] );
                var_dump($graph->keys());
                var_dump($graph->schema);

                foreach ($graph as $key => $value) {
                    echo "$key => $value";
                }
                ?>
                <div class="item">
                    <div class="thumbnail pull-left">

                    </div>
                    <div class="title">
                        <h4><a href="<?=$item['link']; ?>" target="_blank"><?=$item['title']; ?></a></h4>
                    </div>
                    <div class="description">
                        <?php
                        $pos=strpos($item['description'], ' ', 200);
                        echo substr($item['description'], 0, $pos ) . " ...";
                        ?><br />
                        <a href="<?=$item['link']; ?>" target="_blank"><?php __p("read_more"); ?></a>
                    </div>
                </div>
            <?php } ?>
        </div>
    </div>
</div> <!-- End welcome div live -->